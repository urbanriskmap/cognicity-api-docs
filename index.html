
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#api-reference" class="toc-h1 toc-link" data-title="api-reference">API Reference</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#authentication" class="toc-h2 toc-link" data-title="authentication">Authentication</a>
                    </li>
                  <li>
                    <a href="#data-formats" class="toc-h2 toc-link" data-title="data-formats">Data Formats</a>
                    </li>
                  <li>
                    <a href="#version" class="toc-h2 toc-link" data-title="version">Version</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get" class="toc-h3 toc-link" data-title="API Reference">GET /</a>
                          </li>
                      </ul>
                    </li>
              </ul>
          </li>
          <li>
            <a href="#chatbot-api" class="toc-h1 toc-link" data-title="chatbot-api">Chatbot API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#facebook" class="toc-h2 toc-link" data-title="facebook">Facebook</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#post-facebook-send" class="toc-h3 toc-link" data-title="Chatbot API">POST /facebook/send</a>
                          </li>
                          <li>
                            <a href="#get-facebook-webhook" class="toc-h3 toc-link" data-title="Chatbot API">GET /facebook/webhook</a>
                          </li>
                          <li>
                            <a href="#post-facebook-webhook" class="toc-h3 toc-link" data-title="Chatbot API">POST /facebook/webhook</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#twitter" class="toc-h2 toc-link" data-title="twitter">Twitter</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#post-twitter-send" class="toc-h3 toc-link" data-title="Chatbot API">POST /twitter/send</a>
                          </li>
                          <li>
                            <a href="#get-twitter-webhook" class="toc-h3 toc-link" data-title="Chatbot API">GET /twitter/webhook</a>
                          </li>
                          <li>
                            <a href="#post-twitter-webhook" class="toc-h3 toc-link" data-title="Chatbot API">POST /twitter/webhook</a>
                          </li>
                      </ul>
                    </li>
              </ul>
          </li>
          <li>
            <a href="#data-api" class="toc-h1 toc-link" data-title="data-api">Data API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#cards" class="toc-h2 toc-link" data-title="cards">Cards</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-cards-id" class="toc-h3 toc-link" data-title="Data API">GET /cards/:id</a>
                          </li>
                          <li>
                            <a href="#post-cards" class="toc-h3 toc-link" data-title="Data API">POST /cards</a>
                          </li>
                          <li>
                            <a href="#put-cards-id" class="toc-h3 toc-link" data-title="Data API">PUT /cards/:id</a>
                          </li>
                          <li>
                            <a href="#get-cards-id-images" class="toc-h3 toc-link" data-title="Data API">GET /cards/:id/images</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#cities" class="toc-h2 toc-link" data-title="cities">Cities</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-cities" class="toc-h3 toc-link" data-title="Data API">GET /cities</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#feeds" class="toc-h2 toc-link" data-title="feeds">Feeds</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#post-qlue" class="toc-h3 toc-link" data-title="Data API">POST /qlue</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#floods" class="toc-h2 toc-link" data-title="floods">Floods</a>
                    </li>
                  <li>
                    <a href="#infrastructure" class="toc-h2 toc-link" data-title="infrastructure">Infrastructure</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#todo" class="toc-h3 toc-link" data-title="Data API">TODO</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#reports" class="toc-h2 toc-link" data-title="reports">Reports</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#live-reports" class="toc-h3 toc-link" data-title="Data API">Live Reports</a>
                          </li>
                          <li>
                            <a href="#archive" class="toc-h3 toc-link" data-title="Data API">Archive</a>
                          </li>
                          <li>
                            <a href="#timeseries" class="toc-h3 toc-link" data-title="Data API">Timeseries</a>
                          </li>
                      </ul>
                    </li>
              </ul>
          </li>
          <li>
            <a href="#sensors-api" class="toc-h1 toc-link" data-title="sensors-api">Sensors API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-all-sensors" class="toc-h2 toc-link" data-title="get-all-sensors">Get All Sensors</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#http-request" class="toc-h3 toc-link" data-title="Sensors API">HTTP Request</a>
                          </li>
                          <li>
                            <a href="#query-parameters" class="toc-h3 toc-link" data-title="Sensors API">Query Parameters</a>
                          </li>
                          <li>
                            <a href="#response" class="toc-h3 toc-link" data-title="Sensors API">Response</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#get-sensor-data" class="toc-h2 toc-link" data-title="get-sensor-data">Get Sensor Data</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#http-request-2" class="toc-h3 toc-link" data-title="Sensors API">HTTP Request</a>
                          </li>
                          <li>
                            <a href="#url-parameters" class="toc-h3 toc-link" data-title="Sensors API">URL Parameters</a>
                          </li>
                          <li>
                            <a href="#response-2" class="toc-h3 toc-link" data-title="Sensors API">Response</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#create-sensor" class="toc-h2 toc-link" data-title="create-sensor">Create Sensor</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#http-request-3" class="toc-h3 toc-link" data-title="Sensors API">HTTP Request</a>
                          </li>
                          <li>
                            <a href="#new-sensor-attributes" class="toc-h3 toc-link" data-title="Sensors API">New Sensor Attributes</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#add-sensor-data" class="toc-h2 toc-link" data-title="add-sensor-data">Add Sensor Data</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#http-request-4" class="toc-h3 toc-link" data-title="Sensors API">HTTP Request</a>
                          </li>
                          <li>
                            <a href="#url-parameters-2" class="toc-h3 toc-link" data-title="Sensors API">URL Parameters</a>
                          </li>
                          <li>
                            <a href="#new-sensor-attributes-2" class="toc-h3 toc-link" data-title="Sensors API">New Sensor Attributes</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#delete-sensor-data" class="toc-h2 toc-link" data-title="delete-sensor-data">Delete Sensor Data</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#http-request-5" class="toc-h3 toc-link" data-title="Sensors API">HTTP Request</a>
                          </li>
                          <li>
                            <a href="#url-parameters-3" class="toc-h3 toc-link" data-title="Sensors API">URL Parameters</a>
                          </li>
                      </ul>
                    </li>
                  <li>
                    <a href="#delete-sensor" class="toc-h2 toc-link" data-title="delete-sensor">Delete Sensor</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#http-request-6" class="toc-h3 toc-link" data-title="Sensors API">HTTP Request</a>
                          </li>
                      </ul>
                    </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/urbanriskmap/'>CogniCity & Risk Map on GitHub</a></li>
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='api-reference'>API Reference</h1>
<p>Welcome to the CogniCity API. CogniCity is the engine that powers Urban Risk Map. You can use this API to access CogniCity data including flood reports and sensor measurements that are stored in the CogniCity database. You can view example requests in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>

<p>CogniCity deployments are organised into <em>instances</em> for different countries. Each instance may support mapping for one of more cities. Currently available instances:</p>

<ul>
<li><a href="https://petabencana.id">petabencana.id</a></li>
<li><a href="https://riskmap.us">riskmap.us</a></li>
<li><a href="https://riskmap.in">riskmap.in</a></li>
</ul>

<p>The CogniCity API is accessible via the <em>data subdomain</em> of each instance, for example:</p>

<ul>
<li><a href="https://data.riskmap.us">data.riskmap.us</a></li>
</ul>

<p>The CogniCity Sensors API is accessible via the <em>sensors subdomain</em> of each instance, for example:</p>

<ul>
<li><a href="https://sensors.riskmap.us">sensors.riskmap.us</a></li>
</ul>
<h2 id='authentication'>Authentication</h2><pre class="highlight shell tab-shell"><code>curl <span class="s2">"endpoint"</span> -H <span class="s2">"Authorization: token or key"</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="cm">/* Request with API key authentication */</span>
<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/endpoint'</span><span class="p">,</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>

<span class="cm">/* Request with token authentication */</span>
<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/endpoint'</span><span class="p">,</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Authorization'</span><span class="p">:</span> <span class="s1">'token'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<p>Some CogniCity endpoints require authentication in the form of either an API key or a JSON Web Token. Authentication keys and tokens are passed via the <code>x-api-key</code> or <code>Authorization</code> header respectively. Endpoints requiring authentication are detailed below.</p>

<p><code>x-api-key: key</code></p>

<p><code>Authorization: token</code></p>

<aside class="success">
All requests should be made via https.
</aside>
<h4 id='errors'>Errors</h4>
<p>The CogniCity APIs uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>403</td>
<td>Forbiddenj= -- Your API key or authentication token is wrong.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified report could not be found.</td>
</tr>
<tr>
<td>409</td>
<td>Conflict - Report already recieved.</td>
</tr>
<tr>
<td>415</td>
<td>Unsupported Media Type - The file being uploaded is not supported by the system.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests - You have exceeded API request quota.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error - We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable - The service is down and we cannot respond to requests.</td>
</tr>
</tbody></table>
<h2 id='data-formats'>Data Formats</h2>
<blockquote>
<p>Response structure:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Number</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Object</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">Array</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>CogniCity provides responses in JSON format. The <code>statusCode</code> object gives the HTTP response status for the request (also available in the response header). The <code>response</code> property may be either an <code>Object</code> or an <code>Array</code> depending on the data returned.</p>

<p>Where responses contain geographical information both the <a href="http://geojson.org/">GeoJSON</a> and <a href="https://github.com/topojson/topojson">TopoJSON</a> formats are supported.</p>

<p>The <code>/floods</code> endpoint also supports responses using the <a href="https://docs.oasis-open.org/emergency/cap/v1.2/CAP-v1.2-os.html">Common Alerting Protocol</a>, an XML format.</p>

<p>CogniCity uses the <a href="https://www.postgresql.org/docs/current/static/datatype-numeric.html">PostgreSQL BIGINT</a> data type. As these numbers are potentially greater than JavaScript&#39;s <code>Numbers.MAX_SAFE_INTEGER</code> they are returned as strings.</p>
<h2 id='version'>Version</h2><h3 id='get'>GET /</h3>
<p>Gets the CogniCity server and database versions.</p>

<p>The following attributes are returned:</p>

<ul>
<li><code>version</code> refers to CogniCity Server <a href="https://github.com/urbanriskmap/cognicity-server/releases">release version</a></li>
<li><code>schema</code> refers to the CogniCity Database <a href="https://github.com/urbanriskmap/cognicity-schema/releases">release version</a></li>
</ul>
<pre class="highlight shell tab-shell"><code>curl <span class="s1">'/'</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>
<span class="nx">request</span><span class="p">(</span>
  <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
    <span class="na">uri</span><span class="p">:</span> <span class="s1">'/'</span>
  <span class="p">},</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">)</span>
</code></pre>
<blockquote>
<p>Example JSON output:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="s2">"3.0.6"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"schema"</span><span class="p">:</span><span class="s2">"3.0.6"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /</code></p>
<h1 id='chatbot-api'>Chatbot API</h1>
<p>The chatbot API exposes endpoints to receive incoming messages from social media platforms (e.g. via webhooks) and functions to send replies to users (e.g. on succesful report submission). Note that chatbot APIs may run on a custom domain.</p>

<p>The APIs are organised by social media network.</p>
<h2 id='facebook'>Facebook</h2>
<p>Send and receive Facebook messenger events.</p>
<h3 id='post-facebook-send'>POST /facebook/send</h3><pre class="highlight shell tab-shell"><code>curl -X POST <span class="s1">'/facebook/send'</span> -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span> -d <span class="s1">'{
    "reportId": 1,
    "instanceRegionCode": "brw",
    "language": "en",
    "username": "userid",
    "network": "facebook"
}'</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">reportId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">instanceRegionCode</span><span class="p">:</span> <span class="s2">"brw"</span><span class="p">,</span>
    <span class="na">language</span><span class="p">:</span> <span class="s2">"en"</span><span class="p">,</span>
    <span class="na">username</span><span class="p">:</span> <span class="s2">"userid"</span><span class="p">,</span>
    <span class="na">network</span><span class="p">:</span> <span class="s2">"facebook"</span>
  <span class="p">},</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span><span class="s2">```
</span></code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>Send a reply to user after they submit a report via Facebook messenger.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>POST /facebook/send</code></p>
<h4 id='properties'>Properties</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Required</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>reportId</td>
<td>true</td>
<td>The unique ID of the report submitted</td>
<td>none</td>
</tr>
<tr>
<td>instanceRegionCode</td>
<td>true</td>
<td>The instance region containing the report (from the /cities endpoint). May be null.</td>
<td>&quot;brw&quot;</td>
</tr>
<tr>
<td>language</td>
<td>true</td>
<td>The user&#39;s 2 letter language if known. May be null</td>
<td>&quot;en&quot;</td>
</tr>
<tr>
<td>username</td>
<td>true</td>
<td>The username or user id number from the social network</td>
<td>&quot;123&quot;</td>
</tr>
<tr>
<td>network</td>
<td>true</td>
<td>The name of the social network of the user</td>
<td>&quot;facebook&quot;</td>
</tr>
</tbody></table>

<aside class="success">
This request requires an API key for authorization using the `x-api-key` header.
</aside>
<h3 id='get-facebook-webhook'>GET /facebook/webhook</h3><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/facebook/webhook?hub.verify_token=&lt;token&gt;"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">// Webhook configured at developers.facebook.com</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">hub</span><span class="w"> </span><span class="err">challenge</span><span class="w"> </span><span class="err">value</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint responds to a Facebook Webhook authentication challenge. See the Facebook <a href="https://developers.facebook.com/docs/messenger-platform/getting-started/webhook-setup/">developer documentation</a>.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET /facebook/webhook</code></p>
<h3 id='post-facebook-webhook'>POST /facebook/webhook</h3><pre class="highlight sh tab-shell"><code>curl -X POST <span class="s1">'/facebook/webhook'</span> -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span> -d <span class="s1">'{
    &lt;message event&gt;
}'</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">// Webhook configured at developers.facebook.com</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>This endpoint responds to a Facebook Webhook message event. See Facebook <a href="https://developers.facebook.com/docs/messenger-platform/getting-started/webhook-setup/">documentation</a> for more details.</p>
<h4 id='http-request-3'>HTTP Request</h4>
<p><code>POST /facebook/webhook</code></p>
<h2 id='twitter'>Twitter</h2>
<p>Send and receive Twitter direct message events.</p>
<h3 id='post-twitter-send'>POST /twitter/send</h3><pre class="highlight shell tab-shell"><code>curl -X POST <span class="s1">'/twitter/send'</span> -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span> -d <span class="s1">'{
    "reportId": 1,
    "instanceRegionCode": "brw",
    "language": "en",
    "username": "userid",
    "network": "twitter"
}'</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">reportId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">instanceRegionCode</span><span class="p">:</span> <span class="s2">"brw"</span><span class="p">,</span>
    <span class="na">language</span><span class="p">:</span> <span class="s2">"en"</span><span class="p">,</span>
    <span class="na">username</span><span class="p">:</span> <span class="s2">"userid"</span><span class="p">,</span>
    <span class="na">network</span><span class="p">:</span> <span class="s2">"twitter"</span>
  <span class="p">},</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span><span class="s2">```
</span></code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>Send a reply to user after they submit a report as a Twitter direct message.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>POST /twitter/send</code></p>
<h4 id='properties'>Properties</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Required</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>reportId</td>
<td>true</td>
<td>The unique ID of the report submitted</td>
<td>none</td>
</tr>
<tr>
<td>instanceRegionCode</td>
<td>true</td>
<td>The instance region containing the report (from the /cities endpoint). May be null.</td>
<td>&quot;brw&quot;</td>
</tr>
<tr>
<td>language</td>
<td>true</td>
<td>The user&#39;s 2 letter language if known. May be null</td>
<td>&quot;en&quot;</td>
</tr>
<tr>
<td>username</td>
<td>true</td>
<td>The username or user id number from the social network</td>
<td>&quot;123&quot;</td>
</tr>
<tr>
<td>network</td>
<td>true</td>
<td>The name of the social network of the user</td>
<td>&quot;twitter&quot;</td>
</tr>
</tbody></table>

<aside class="success">
This request requires an API key for authorization using the `x-api-key` header.
</aside>
<h3 id='get-twitter-webhook'>GET /twitter/webhook</h3><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/twitter/webhook?crc_token=&lt;token&gt;"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">// Webhook configured at developer.twitter.com</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"response_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;token&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint responds to a twitter Webhook challenge response check. See the Twitter <a href="https://developer.twitter.com/en/docs/accounts-and-users/subscribe-account-activity/overview">developer documentation</a>.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET /twitter/webhook</code></p>
<h3 id='post-twitter-webhook'>POST /twitter/webhook</h3><pre class="highlight sh tab-shell"><code>curl -X POST <span class="s1">'/twitter/webhook'</span> -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span> -d <span class="s1">'{
    &lt;message event&gt;
}'</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">// Webhook configured at developer.twitter.com</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>This endpoint responds to a Twitter webhook message event. See twitter <a href="https://developers.twitter.com/docs/messenger-platform/getting-started/webhook-setup/">documentation</a> for more details.</p>
<h4 id='http-request-3'>HTTP Request</h4>
<p><code>POST /twitter/webhook</code></p>
<h1 id='data-api'>Data API</h1>
<p>The Data API provides the core reporting and mapping functionality of CogniCity. The Cards endpoint enables residents to submit hazard reports and the Reports endpoint provides submitted reports for client applications. Additional endpoints support the core funciotnality with additional data.</p>
<h2 id='cards'>Cards</h2>
<p>Report cards for diaster events issued via social media chatbots. Report cards are the mechanism by which users can submit hazard reports. Cards are issued using a one-time-link based on a globally unique identifier (GUID) and can only be used to submit one hazard report. Subsequent hazard reports may be submitted by the user requesting a new card.</p>

<p>The card flow is as follows:</p>

<ol>
<li>Request a new card (POST /cards)</li>
<li>Submit hazard report (PUT /cards/:id)</li>
<li>Upload image (GET /cards/:id/images)</li>
</ol>
<h3 id='get-cards-id'>GET /cards/:id</h3>
<p>This endpoint lists the status of a card. It is useful for checking whether a card has already been used to submit a hazard report.</p>
<pre class="highlight shell tab-shell"><code>curl /cards/:id
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/cards'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured as shown below. Note that in this example the card has not yet been submitted by the user. When querying a report that has been submitted additional report details including reportId are provided by this endpoint.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"card_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"guid"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"network"</span><span class="p">:</span><span class="w"> </span><span class="s2">"twitter"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"report"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /cards/:id</code></p>
<h3 id='post-cards'>POST /cards</h3>
<p>This endpoint creates a new card with a GUI, in preparation for submission of hazard information by user.</p>
<pre class="highlight shell tab-shell"><code>curl -X POST /cards
  -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-api-key: api-key'</span> <span class="se">\</span>
  -d <span class="s1">'{
    "username": "123",
    "network":"twitter",
    "language":"en"
}'</span> 
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/cards'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">username</span><span class="p">:</span> <span class="s2">"123"</span><span class="p">,</span>
    <span class="na">network</span><span class="p">:</span> <span class="s2">"twitter"</span><span class="p">,</span>
    <span class="na">language</span><span class="p">:</span> <span class="s2">"en"</span>
  <span class="p">},</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"cardId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"guid"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='http-request-2'>HTTP Request</h4>
<p><code>POST /cards</code></p>
<h4 id='new-card-attributes'>New Card Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>username</td>
<td>string</td>
<td>User social network username or id</td>
<td>Yes</td>
</tr>
<tr>
<td>network</td>
<td>string</td>
<td>Name of social network (e.g. &#39;twitter&#39;)</td>
<td>Yes</td>
</tr>
<tr>
<td>language</td>
<td>string</td>
<td>Two-letter language code for user (e.g. &#39;en&#39;)</td>
<td>Yes</td>
</tr>
</tbody></table>

<aside class="success">
This request requires an API key for authorization using the `x-api-key` header.
</aside>
<h3 id='put-cards-id'>PUT /cards/:id</h3>
<p>This endpoint receives card information to create a hazard report. Once data is received a report will be generated and become available in the reports endpoint.</p>
<pre class="highlight shell tab-shell"><code>curl -X PUT /cards/:id
  -H <span class="s1">'Content-Type: application/json'</span>
  -H <span class="s1">'x-api-key: api_key'</span> 
  -d <span class="s1">'{
    "card_data":{
        "report_type":"flood",
        "flood_depth": 20
        },
    "disaster_type": "flood",
    "text": "Very big flood",
    "created_at":"2016-12-13T19:25:29",
    "location": {
        "lat":-6.4,
        "lng":106.6
    }
}'</span> 
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">card_data</span><span class="p">:{</span>
        <span class="na">report_type</span><span class="p">:</span><span class="s2">"flood"</span><span class="p">,</span>
        <span class="na">flood_depth</span><span class="p">:</span> <span class="mi">20</span>
        <span class="p">},</span>
    <span class="na">disaster_type</span><span class="p">:</span> <span class="s2">"flood"</span><span class="p">,</span>
    <span class="na">text</span><span class="p">:</span> <span class="s2">"Very big flood"</span><span class="p">,</span>
    <span class="na">created_at</span><span class="p">:</span><span class="s2">"2016-12-13T19:25:29"</span><span class="p">,</span>
    <span class="na">location</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">lat</span><span class="p">:</span><span class="o">-</span><span class="mf">6.4</span><span class="p">,</span>
        <span class="na">lng</span><span class="p">:</span><span class="mf">106.6</span>
    <span class="p">}</span>
  <span class="p">},</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cardId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"guid"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='http-request-3'>HTTP Request</h4>
<p><code>PUT /cards/:id</code></p>
<h4 id='card-report-attributes'>Card Report Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>card_data</td>
<td>object</td>
<td>Object containing hazard specific data</td>
<td>Yes</td>
</tr>
<tr>
<td>disaster_type</td>
<td>string</td>
<td>Hazard type</td>
<td>Yes</td>
</tr>
<tr>
<td>text</td>
<td>string</td>
<td>Hazard description</td>
<td>Yes</td>
</tr>
<tr>
<td>created_at</td>
<td>string</td>
<td>Timestamp in ISO8601 format YYYY-MM-DDTHH:MM:SS</td>
<td>Yes</td>
</tr>
<tr>
<td>disaster_type</td>
<td>string</td>
<td>Hazard type</td>
<td>Yes</td>
</tr>
<tr>
<td>location</td>
<td>object</td>
<td>Point location, latitude and longitude</td>
<td>Yes</td>
</tr>
</tbody></table>
<h3 id='get-cards-id-images'>GET /cards/:id/images</h3>
<p>Get a signed AWS S3 URL to upload an image associated with a card. This must be done after card report has been created. Only one image can exist for a given card. See more in the AWS <a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html#getSignedUrl-property">documentation</a>.</p>
<pre class="highlight shell tab-shell"><code>curl GET /cards/:id/images
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/cards/:id/images'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured as shown below.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signedRequest"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://s3.us-west-2.amazonaws.com/domain/originals/guid.jpeg?aws-signature"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://s3.us-west-2.amazonaws.com/domain/originals/guid.jpeg"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='http-request-4'>HTTP Request</h4>
<p><code>GET /cards/:id/images</code></p>

<aside class="notice">
After an image is submitted a server-side process shrinks the image to a standard size and there may be a small time lag of a few seconds before the image goes "live" with the report.
</aside>
<h2 id='cities'>Cities</h2>
<p>CogniCity deployments are organised by city. Cities are delineated by a unique three letter code and a bounding box geometry. Note that the term &quot;city&quot; is used somewhat arbitrairily for organisational purposes. Cities may refer to an urban conurbation or wider metropolitan area. For example in the United States &quot;Broward&quot; is used to refer to Broward County which includes multiple cities and non-urban areas.</p>
<h3 id='get-cities'>GET /cities</h3><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/cities?geoformat=geojson"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/cities'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">geoformat</span><span class="p">:</span> <span class="s1">'geojson'</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Polygon"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">[</span><span class="w">
              </span><span class="p">[</span><span class="w">
                </span><span class="mf">-80.56454636</span><span class="p">,</span><span class="w">
                </span><span class="mf">26.4393434677</span><span class="w">
              </span><span class="p">],</span><span class="w">
              </span><span class="p">[</span><span class="w">
                </span><span class="mf">-80.011194015</span><span class="p">,</span><span class="w">
                </span><span class="mf">26.4376911515</span><span class="w">
              </span><span class="p">],</span><span class="w">
              </span><span class="p">[</span><span class="w">
                </span><span class="mf">-80.0147106747</span><span class="p">,</span><span class="w">
                </span><span class="mf">25.8743814793</span><span class="w">
              </span><span class="p">],</span><span class="w">
              </span><span class="p">[</span><span class="w">
                </span><span class="mf">-80.5690752042</span><span class="p">,</span><span class="w">
                </span><span class="mf">25.8759818852</span><span class="w">
              </span><span class="p">],</span><span class="w">
              </span><span class="p">[</span><span class="w">
                </span><span class="mf">-80.56454636</span><span class="p">,</span><span class="w">
                </span><span class="mf">26.4393434677</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"brw"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"broward"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns all cities covered by the CogniCity instance, including their three letter code and bounding box geometry.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>GET /cities</code></p>
<h4 id='query-parameters'>Query Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>geoformat</td>
<td>false</td>
<td>Specifies either &#39;geojson&#39; or &#39;topojson&#39;</td>
<td>topojson</td>
</tr>
</tbody></table>
<h4 id='response'>Response</h4>
<p>The returned data uses the GeoJSON FeatureCollection or TopoJSON GeometryCollection types. The properties of each sensor feature as described in the following table.</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>string</td>
<td>Unique 3 letter code for each city</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>City name</td>
</tr>
</tbody></table>
<h2 id='feeds'>Feeds</h2>
<p>The feeds endpoint supports input of hazard reports from third-party data-streams such as local civic applications. Reports collected from external data feeds are available from the /reports endpoint.</p>
<h3 id='post-qlue'>POST /qlue</h3>
<p>This endpoint accepts hazard reports from the <a href="http://www.qlue.co.id/">Qlue Smart City Application</a>.</p>
<pre class="highlight shell tab-shell"><code>curl -X post /feeds/qlue
  -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-api-key: api-key'</span> <span class="se">\</span>
  -d <span class="s1">'{
    "post_id": "123",
    "created_at": "twitter",
    "title": "en",
    "text": "flooding!",
    "image_url": "url",
    "qlue_city": "jabodetabek",
    "disaster_type": "flood",
    "location": {
        "lat":-6.2,
        "lon":106.8
    }
}'</span> 
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/feeds/qlue'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">post_id</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
    <span class="na">created_at</span><span class="p">:</span> <span class="s2">"2018-06-18T00:00+0700"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"en"</span><span class="p">,</span>
    <span class="na">text</span><span class="p">:</span> <span class="s2">"flooding!"</span><span class="p">,</span>
    <span class="na">image_url</span><span class="p">:</span> <span class="s2">"url"</span><span class="p">,</span>
    <span class="na">qlue_city</span><span class="p">:</span> <span class="s2">"jabodetabek"</span><span class="p">,</span>
    <span class="na">disaster_type</span><span class="p">:</span> <span class="s2">"flood"</span><span class="p">,</span>
    <span class="na">location</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">lat</span><span class="p">:</span><span class="o">-</span><span class="mf">6.2</span><span class="p">,</span>
        <span class="na">lon</span><span class="p">:</span><span class="mf">106.8</span>
    <span class="p">}</span>
  <span class="p">},</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"post_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='http-request'>HTTP Request</h4>
<p><code>POST /feeds/qlue</code></p>
<h4 id='qlue-report-attributes'>Qlue Report Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>post_id</td>
<td>number</td>
<td>Qlue identifier</td>
<td>Yes</td>
</tr>
<tr>
<td>created_at</td>
<td>string</td>
<td>Timestamp in ISO8601 format YYYY-MM-DDTHH:MM:SS</td>
<td>Yes</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>Title of report</td>
<td>No</td>
</tr>
<tr>
<td>text</td>
<td>string</td>
<td>Hazard description</td>
<td>Yes</td>
</tr>
<tr>
<td>image_url</td>
<td>string</td>
<td>URL of image</td>
<td>No</td>
</tr>
<tr>
<td>qlue_city</td>
<td>string</td>
<td>City of report origin</td>
<td>No</td>
</tr>
<tr>
<td>disaster_type</td>
<td>string</td>
<td>Hazard type</td>
<td>Yes</td>
</tr>
<tr>
<td>location</td>
<td>object</td>
<td>Point location, latitude and longitude</td>
<td>Yes</td>
</tr>
</tbody></table>
<h2 id='floods'>Floods</h2><h2 id='infrastructure'>Infrastructure</h2><h3 id='todo'>TODO</h3><h2 id='reports'>Reports</h2>
<p>The reports endpoint contains CogniCity reports submitted by the public. Reports are represented by point-geometries and their accompanying properties (e.g. description, time etc.). Note that all times are UTC, and geometries use the WGS 1984 coordinate system.</p>
<h3 id='live-reports'>Live Reports</h3><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/reports?city=brw&amp;geoformat=geojson"</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/reports'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">city</span><span class="p">:</span> <span class="s1">'brw'</span><span class="p">,</span>
    <span class="na">geoformat</span><span class="p">:</span> <span class="s1">'geojson'</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>

</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Point"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="mf">-80.0946879387</span><span class="p">,</span><span class="w">
            </span><span class="mf">26.1381793399</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"pkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"94"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-19T17:53:43.229Z"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"grasp"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"confirmed"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ad63ccb2-024f-4617-81a1-4e8782499afa"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://images.riskmap.us/ad63ccb2-024f-4617-81a1-4e8782499afa.jpg"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"disaster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flood"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"report_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"report_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flood"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"flood_depth"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"district_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"local_area_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"instance_region_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"brw"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test flood report (MIT)"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves all reports.  Note that all times are UTC, and geometries use the WGS 1984 coordinate system.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>GET /reports</code></p>
<h4 id='query-parameters'>Query Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
<th>Default</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>city</td>
<td>false</td>
<td>Filter reports by 3-letter city code (see cities endpoint for details). If no city specified then reports for all cities in CogniCity instance are returned</td>
<td>none</td>
<td>brw</td>
</tr>
<tr>
<td>geoformat</td>
<td>false</td>
<td>Specifies either &#39;geojson&#39; or &#39;topojson&#39;</td>
<td>topojson</td>
<td>geojson</td>
</tr>
<tr>
<td>timeperiod</td>
<td>false</td>
<td>Time period in seconds to filter reports by, must be strictly between 1 and 604800 (1 week)</td>
<td>3600 (1 hour)</td>
<td>3600</td>
</tr>
</tbody></table>
<h3 id='archive'>Archive</h3><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/reports/archive?city=brw&amp;geoformat=geojson&amp;start=2018-06-15T00:00:00-0400&amp;end=2018-06-19T15:00:00-0400"</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/reports/archive'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">city</span><span class="p">:</span> <span class="s1">'brw'</span><span class="p">,</span>
    <span class="na">geoformat</span><span class="p">:</span> <span class="s1">'geojson'</span><span class="p">,</span>
    <span class="na">start</span><span class="p">:</span> <span class="s1">'2018-06-15T00:00:00-0400'</span><span class="p">,</span>
    <span class="na">end</span><span class="p">:</span> <span class="s1">'2017-06-19T15:00:00-0400'</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>

</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Point"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="mf">-80.0977993011</span><span class="p">,</span><span class="w">
            </span><span class="mf">26.140336808</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"pkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-15T18:48:57.084Z"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"grasp"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"confirmed"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d56c91dc-15c9-4d3b-83f1-cc86b94ae330"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"disaster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flood"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"report_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"report_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flood"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"flood_depth"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"district_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"local_area_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1375"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"instance_region_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"brw"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test flood"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves reports within the specified time period. The maximum duration between start and end times is one week. Note that all times are UTC, and geometries use the WGS 1984 coordinate system.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET /reports/archive</code></p>
<h4 id='query-parameters-2'>Query Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
<th>Default</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>city</td>
<td>false</td>
<td>Filter reports by 3-letter city code (see cities endpoint for details). If no city specified then reports for all cities in CogniCity instance are returned</td>
<td>none</td>
<td>brw</td>
</tr>
<tr>
<td>geoformat</td>
<td>false</td>
<td>Specifies either &#39;geojson&#39; or &#39;topojson&#39;</td>
<td>topojson</td>
<td>geojson</td>
</tr>
<tr>
<td>start</td>
<td>true</td>
<td>Start time for archive period in ISO 8601 string format</td>
<td>none</td>
<td>2018-06-15T00:00:00-0400</td>
</tr>
<tr>
<td>end</td>
<td>true</td>
<td>End time for archive period in ISO 8601 string format. Must bet within 604800 seconds (1 week) from start time</td>
<td>none</td>
<td>2017-06-19T15:00:00-0400</td>
</tr>
</tbody></table>

<aside class="success">
Start and end times require UTC offsets using either '+' or '-' which need to be URL encoded as '%2B' and '%2D' respectively.
</aside>
<h3 id='timeseries'>Timeseries</h3><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/reports/timeseries?city=brw&amp;start=2018-06-19T13:00:00%2D0400&amp;end=2018-06-19T15:00:00%2D0400"</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/reports/timeseries'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">start</span><span class="p">:</span> <span class="s1">'2018-06-19T13:00:00-0400'</span><span class="p">,</span>
    <span class="na">end</span><span class="p">:</span> <span class="s1">'2018-06-19T15:00:00-0400'</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>

</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"ts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-19T17:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"ts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-19T18:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"ts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-19T19:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint generates a time series of reports presented as a count of reports every hour within the specified time period. The maximum duration between start and end times is one week. Report count is recorded alongside an hourly UTC timestamp in ISO 8061 format.</p>
<h4 id='http-request-3'>HTTP Request</h4>
<p><code>GET /reports/timeseries</code></p>
<h4 id='query-parameters-3'>Query Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
<th>Default</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>city</td>
<td>false</td>
<td>Filter reports by 3-letter city code (see cities endpoint for details). If no city specified then reports for all cities in CogniCity instance are returned</td>
<td>none</td>
<td>jbd</td>
</tr>
<tr>
<td>start</td>
<td>true</td>
<td>Start time for archive period in ISO 8601 string format</td>
<td>none</td>
<td>2017-02-21T07:00:00+0700</td>
</tr>
<tr>
<td>end</td>
<td>true</td>
<td>End time for archive period in ISO 8601 string format. Must bet within 604800 seconds (1 week) from start time</td>
<td>none</td>
<td>2017-02-21T19:00:00+0700</td>
</tr>
</tbody></table>

<aside class="success">
Start and end times require UTC offsets using either '+' or '-' which need to be URL encoded as '%2B' and '%2D' respectively.
</aside>
<h1 id='sensors-api'>Sensors API</h1>
<p>The CogniCity Sensors endpoints supports centralizing data from automated sensor networks. Sensor data can be inserted into the database for storage, and subsequently served as GeoJSON or TopoJSON to support map visualisations.</p>

<p>Sensor locations are point geometries defined using latitude and longitude coordinates in the WGS 1984 coordinate system.</p>

<aside class="notice">
Note that these endpoints reside on a separate sensors subdomain.
</aside>
<h2 id='get-all-sensors'>Get All Sensors</h2><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/?bbox=-81,27,-79,25&amp;geoformat=geojson"</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">bbox</span><span class="p">:</span> <span class="s1">'-81,27,-79,25'</span><span class="p">,</span>
    <span class="na">geoformat</span><span class="p">:</span> <span class="s1">'geojson'</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>

</code></pre>
<blockquote>
<p>The response body contains the following JSON object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Point"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="mf">-80.3853056</span><span class="p">,</span><span class="w">
                </span><span class="mf">26.0341111</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-10-24T22:35:58.875Z"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"uid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"260653080184901"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GW"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"62610"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"units"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ft"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Point"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="mf">-80.1153333</span><span class="p">,</span><span class="w">
                </span><span class="mf">26.31780556</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-10-24T22:35:58.883Z"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"uid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"261903080065601"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GW"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"62610"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"units"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ft"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns a collection of sensors and their properties within the specified bounding box. If no bounding box is provided all sensors in the database will be returned.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
<th>Default</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>bbox</td>
<td>false</td>
<td>A list of longitude and latitude pairs representing the top left and bottom right corners of a bounding box for sensor locations.</td>
<td>none</td>
<td>longitude, latitude, longitude, latitude</td>
</tr>
<tr>
<td>geoformat</td>
<td>false</td>
<td>Specifies either &#39;geojson&#39; or &#39;topojson&#39;</td>
<td>geojson</td>
<td>geojson</td>
</tr>
<tr>
<td>agency</td>
<td>false</td>
<td>Optional filter properties.agency of the sensor (e.g. &#39;USGS&#39;)</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<p>The returned data uses the GeoJSON FeatureCollection or TopoJSON GeometryCollection types. The properties of each sensor feature as described in the following table.</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Unique sensor identifier</td>
</tr>
<tr>
<td>created</td>
<td>string</td>
<td>timestamp sensor created in database (ISO 8601 format)</td>
</tr>
<tr>
<td>properties</td>
<td>json</td>
<td>metadata attributes for each sensor</td>
</tr>
</tbody></table>
<h2 id='get-sensor-data'>Get Sensor Data</h2><pre class="highlight shell tab-shell"><code>curl <span class="s2">"/3"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/3'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"dataId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"24439"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sensorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-03-16T17:37:47.116Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"observation"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"observations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.84"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-03-15T13:45:00.000-04:00"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.84"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-03-15T14:00:00.000-04:00"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves a list of data for a specific sensor. Data are organised into records, indexed by the <code>id</code> attribute. The <code>created</code> attribute details when the record was last updated. The <code>properties</code> attribute contains the data for the record. The <code>properties</code> object may be in varying formats. The example shows a <code>properties</code> object for a single data record which contains an <code>observations</code> array of measurements. Data records are returned in reverse chronological order by <code>created</code> date.</p>

<aside class="warn">
When a sensor does not have any data associated with it the endpoint will return a 404 error "No data found for sensor [ID]".
</aside>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET /&lt;ID&gt;</code></p>
<h3 id='url-parameters'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the sensor to retrieve</td>
</tr>
<tr>
<td>type</td>
<td>Optional filter for the type field</td>
</tr>
<tr>
<td>limit</td>
<td>Optional limit on number of returned records</td>
</tr>
</tbody></table>
<h3 id='response-2'>Response</h3>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dataId</td>
<td>integer</td>
<td>Unique data record identifier</td>
</tr>
<tr>
<td>sensorId</td>
<td>integer</td>
<td>The ID of the sensor</td>
</tr>
<tr>
<td>created</td>
<td>string</td>
<td>Data record update time (ISO 8601 format)</td>
</tr>
<tr>
<td>properties</td>
<td>object</td>
<td>Record data</td>
</tr>
</tbody></table>
<h2 id='create-sensor'>Create Sensor</h2><pre class="highlight shell tab-shell"><code>curl -X POST / -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span> -d <span class="s1">'{
    "properties":{
        "name": "test sensor",
    "agency": "usgs"
    },
    "location":{
        "lat": 25.0,
        "lng": -80.0
    }
}'</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s2">"test sensor"</span><span class="p">,</span>
      <span class="na">agency</span><span class="p">:</span> <span class="s2">"usgs"</span>
    <span class="p">},</span>
    <span class="na">location</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">lat</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">,</span>
      <span class="na">lng</span><span class="p">:</span> <span class="o">-</span><span class="mf">80.0</span>
    <span class="p">}</span>
  <span class="p">},</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Point"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="mf">-80.0</span><span class="p">,</span><span class="w">
                        </span><span class="mf">25.0</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-03-16T18:25:07.613Z"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test sensor"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"agency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usgs"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint creates a new sensor. On success a GeoJSON feature representing the new sensor is returned.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>POST /</code></p>

<aside class="success">
This request requires an API key for authorization using the `x-api-key` header.
</aside>
<h3 id='new-sensor-attributes'>New Sensor Attributes</h3>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>properties</td>
<td>object</td>
<td>Sensor metadata properties</td>
<td>Yes</td>
</tr>
<tr>
<td>properties.agency</td>
<td>string</td>
<td>Optional agency tag for sensor (e.g. &#39;usgs&#39;)</td>
<td></td>
</tr>
<tr>
<td>location</td>
<td>object</td>
<td>An object with <code>lat</code> and <code>lng</code> numerical values representing the sensor&#39;s latitude and longitude</td>
<td>Yes</td>
</tr>
</tbody></table>
<h2 id='add-sensor-data'>Add Sensor Data</h2><pre class="highlight shell tab-shell"><code>curl -X POST /4 -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span> -d <span class="s1">'{
    "properties":{
        "METAR": "CYYQ 182200Z 07002KT 15SM OVC017 06/03 A2966 RMK SC10 3 POLAR BEARS ALNG RNWY==",
    "type": "observation"
  }
}'</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// package to make http requests</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/4'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">METAR</span><span class="p">:</span> <span class="s2">"CYYQ 182200Z 07002KT 15SM OVC017 06/03 A2966 RMK SC10 3 POLAR BEARS ALNG RNWY=="</span><span class="p">,</span>
      <span class="na">type</span><span class="p">:</span> <span class="s2">"observation"</span>
    <span class="p">},</span>
  <span class="p">},</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>

</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"dataId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"240288"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sensorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-03-16T19:30:33.042Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint adds a new data record to the specified sensor. On success the sensor ID and an updated timestamp are returned.</p>

<aside class="success">
This request requires an API key for authorization using the `x-api-key` header.
</aside>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>POST /&lt;ID&gt;</code></p>
<h3 id='url-parameters-2'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the sensor</td>
</tr>
</tbody></table>
<h3 id='new-sensor-attributes-2'>New Sensor Attributes</h3>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>properties</td>
<td>object</td>
<td>New data record to be added</td>
<td>Yes</td>
</tr>
<tr>
<td>properties.type</td>
<td>string</td>
<td>Optional type tag for different measurement types (e.g. observation vs manual, or mean vs daily max)</td>
<td></td>
</tr>
</tbody></table>
<h2 id='delete-sensor-data'>Delete Sensor Data</h2><pre class="highlight sh tab-shell"><code>curl -X DELETE /4/2345 -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// http requests</span>
<span class="c1">// delete record 2345 from sensor 4</span>
<span class="nx">axios</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'/sensors/4/2345'</span><span class="p">,</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">},</span> <span class="p">{</span><span class="s1">'content-type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint deletes a data record for the specified sensor. On success the statusCode and an empty body object are returned.</p>

<aside class="success">
This request requires an API key for authorization using the `x-api-key` header.
</aside>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>DELETE /&lt;ID&gt;/&lt;DATAID&gt;</code></p>
<h3 id='url-parameters-3'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the sensor</td>
</tr>
<tr>
<td>DATAID</td>
<td>The ID of the data record to delete</td>
</tr>
</tbody></table>
<h2 id='delete-sensor'>Delete Sensor</h2><pre class="highlight sh tab-shell"><code>curl -X DELETE /4 -H <span class="s1">'Content-Type: application/json'</span> -H <span class="s1">'x-api-key: key'</span>

</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">'axios'</span><span class="p">;</span> <span class="c1">// http requests</span>
<span class="c1">// delete record 2345 from sensor 4</span>
<span class="nx">axios</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'/sensors/4'</span><span class="p">,</span> <span class="p">{</span><span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'x-api-key'</span><span class="p">:</span> <span class="s1">'key'</span><span class="p">},</span> <span class="p">{</span><span class="s1">'content-type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">}})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"statusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint deletes a sensor and any data from that sensor. On success the statusCode and an empty body object are returned.</p>

<aside class="success">
This request requires an API key for authorization using the `x-api-key` header.
</aside>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>DELETE /&lt;ID&gt;</code></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
